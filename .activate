#!/bin/sh
ENV_LIST="local dev"
ENV_TYPE=$1
PROJECT_NAME=$(basename $(pwd))

if echo $ENV_LIST | grep -w $ENV_TYPE > /dev/null; then
    ENV_FILE=.env.$ENV_TYPE
    DOCKER_COMPOSE_FILE=$ENV_TYPE.yml
else
   echo "Option must be 'local' or 'dev'"
   return
fi


# Export environment variables
if [ -f "$ENV_FILE" ]; then
	set -o allexport
	source "$ENV_FILE"
	set +o allexport
fi

# Activate virtualenv
pyenv activate $PROJECT_NAME

# Run needed containers
if [ -f "$DOCKER_COMPOSE_FILE" ]; then
	docker-compose -p $PROJECT_NAME -f $DOCKER_COMPOSE_FILE up -d
fi
